time="2026-02-03T13:30:33Z" level=warning msg="/opt/shop-intelligence/antigravity_deploy/deploy/docker-compose.prod.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 Image deploy-graph_builder Building 
#1 [internal] load local bake definitions
#1 reading from stdin 602B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 203B done
#2 DONE 0.1s

#3 [internal] load metadata for docker.io/library/node:20-alpine
#3 DONE 0.8s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 17.41kB done
#5 DONE 0.1s

#6 [1/5] FROM docker.io/library/node:20-alpine@sha256:09e2b3d9726018aecf269bd35325f46bf75046a643a66d28360ec71132750ec8
#6 resolve docker.io/library/node:20-alpine@sha256:09e2b3d9726018aecf269bd35325f46bf75046a643a66d28360ec71132750ec8 0.1s done
#6 DONE 0.2s

#6 [1/5] FROM docker.io/library/node:20-alpine@sha256:09e2b3d9726018aecf269bd35325f46bf75046a643a66d28360ec71132750ec8
#6 sha256:e31b2016552274339ed88ed4a438d78bf37e0f6bdf328d02207b2a598c1ef86d 445B / 445B 0.1s done
#6 sha256:eb87f4721c91769ed5206f34a9ab6ec98fc1d5235c12c2fc956665b1155e9ecb 1.26MB / 1.26MB 0.3s done
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 0B / 42.78MB 0.2s
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 13.63MB / 42.78MB 0.5s
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 23.07MB / 42.78MB 0.6s
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 30.34MB / 42.78MB 0.8s
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 38.80MB / 42.78MB 0.9s
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 42.78MB / 42.78MB 1.1s
#6 sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 42.78MB / 42.78MB 1.2s done
#6 extracting sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80
#6 extracting sha256:ad6d96c196e3198e14ea37df8bba4f54bf92fb525eb65e49fa4027c7dee13f80 1.6s done
#6 DONE 3.1s

#6 [1/5] FROM docker.io/library/node:20-alpine@sha256:09e2b3d9726018aecf269bd35325f46bf75046a643a66d28360ec71132750ec8
#6 extracting sha256:eb87f4721c91769ed5206f34a9ab6ec98fc1d5235c12c2fc956665b1155e9ecb 0.1s done
#6 extracting sha256:e31b2016552274339ed88ed4a438d78bf37e0f6bdf328d02207b2a598c1ef86d 0.0s done
#6 DONE 3.2s

#7 [2/5] WORKDIR /app
#7 DONE 1.0s

#8 [3/5] COPY package.json package-lock.json* ./
#8 DONE 0.1s

#9 [4/5] RUN npm install --omit=dev
#9 3.653 
#9 3.653 added 37 packages, and audited 38 packages in 3s
#9 3.653 
#9 3.653 2 packages are looking for funding
#9 3.653   run `npm fund` for details
#9 3.656 
#9 3.656 found 0 vulnerabilities
#9 3.658 npm notice
#9 3.658 npm notice New major version of npm available! 10.8.2 -> 11.8.0
#9 3.658 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.8.0
#9 3.658 npm notice To update run: npm install -g npm@11.8.0
#9 3.658 npm notice
#9 DONE 3.8s

#10 [5/5] COPY src ./src
#10 DONE 0.1s

#11 exporting to image
#11 exporting layers
#11 exporting layers 0.8s done
#11 exporting manifest sha256:8ae1f521a158d7a5317453e83cb6d970e611cc67ff1a0b619dc38f2c4481bcda 0.0s done
#11 exporting config sha256:4f6f1e2b5dece750f58645378c56bd40459b9a07ba3c5d4a1bfab2606b8812e5 0.0s done
#11 exporting attestation manifest sha256:a6373237f5342ad829be7063f773628610e80ff1ff11a678a50624e4aa85460e 0.1s done
#11 exporting manifest list sha256:43d7db105aad43b8dde9d617cecb8419a6e391bd53ed0d5b8cf34516b8fab405
#11 exporting manifest list sha256:43d7db105aad43b8dde9d617cecb8419a6e391bd53ed0d5b8cf34516b8fab405 0.0s done
#11 naming to docker.io/library/deploy-graph_builder:latest done
#11 unpacking to docker.io/library/deploy-graph_builder:latest
#11 unpacking to docker.io/library/deploy-graph_builder:latest 0.6s done
#11 DONE 1.6s

#12 resolving provenance for metadata file
#12 DONE 0.0s
 Image deploy-graph_builder Built 
 Container shop_falkordb Running 
 Container shop_pg Running 
 Container shop_graph_builder Creating 
 Container shop_graph_builder Created 
Attaching to shop_graph_builder
 Container shop_pg Waiting 
 Container shop_pg Healthy 
 Container shop_flyway Starting 
 Container shop_flyway Started 
 Container shop_flyway Waiting 
 Container shop_falkordb Waiting 
 Container shop_falkordb Healthy 
 Container shop_flyway Exited 
 Container shop_graph_builder Starting 
 Container shop_graph_builder Started 
shop_graph_builder  | 
shop_graph_builder  | > shop-graph-builder@0.1.0 start
shop_graph_builder  | > node src/index.js
shop_graph_builder  | 
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.646Z","mode":"full_rebuild","graphName":"shop","msg":"Graph Builder starting"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.684Z","graphName":"shop","msg":"Starting full graph rebuild"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.753Z","view":"graph_export.node_machines","count":10,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.756Z","label":"Machine","msg":"Upserted nodes"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.763Z","view":"graph_export.node_parts","count":140,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.789Z","label":"Part","msg":"Upserted nodes"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.792Z","view":"graph_export.node_customers","count":30,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.800Z","label":"Customer","msg":"Upserted nodes"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.803Z","view":"graph_export.node_jobs","count":0,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.803Z","label":"Job","msg":"Upserted nodes"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.806Z","view":"graph_export.node_operations","count":0,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.806Z","label":"Operation","msg":"Upserted nodes"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.814Z","view":"graph_export.node_tools","count":130,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.853Z","label":"Tool","msg":"Upserted nodes"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.856Z","view":"graph_export.node_holders","count":14,"msg":"Fetched node rows"}
shop_graph_builder  | {"level":30,"time":"2026-02-03T13:30:50.860Z","label":"Holder","msg":"Upserted nodes"}
shop_graph_builder  | {"level":50,"time":"2026-02-03T13:30:50.867Z","err":{"type":"DatabaseError","message":"invalid input syntax for type bigint: \"A00001\"","stack":"error: invalid input syntax for type bigint: \"A00001\"\n    at /app/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async queryAll (file:///app/src/postgres.js:20:15)\n    at async upsertNodes (file:///app/src/builder.js:194:16)\n    at async runFullRebuild (file:///app/src/builder.js:255:5)\n    at async main (file:///app/src/index.js:15:7)","length":111,"name":"error","severity":"ERROR","code":"22P02","file":"numutils.c","line":"879","routine":"pg_strtoint64_safe"},"msg":"Graph Builder fatal error"}
[Kshop_graph_builder exited with code 1
